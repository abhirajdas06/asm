{% extends 'dashboard/index.html' %}
{% load crispy_forms_tags %}
{% block body %}
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-body">

                <h4 class="mt-0 header-title"></h4>

                <form method="post"   id="HardwareCreateForm" data-category-url="{% url 'ajax_load_category' %}>
                    {% csrf_token %}

                    <div class="form-row">
                        <div class="form-group col-md-3 mb-0">
                            {{form.name|as_crispy_field}}

                        </div>
                        <div class="form-group col-md-3 mb-0">
                            {{form.brand|as_crispy_field}}

                        </div>
                        
                        <div class="form-group col-md-3 mb-0">
                            {{form.category|as_crispy_field}}

                        </div>

                        <div class="form-group col-md-3 mb-0">
                            {{form.subcategory|as_crispy_field}}

                        </div>
                        <div class="form-group col-md-3 mb-0">
                            {{form.barcode|as_crispy_field}}

                        </div>

                        <div class="form-group col-md-3 mb-0">
                            {{form.serial|as_crispy_field}}

                        </div>

                        <div class="form-group col-md-3 mb-0">
                            {{form.vendor|as_crispy_field}}

                        </div>

                        <div class="form-group col-md-3 mb-0">
                            {{form.purchased_on|as_crispy_field}}

                        </div>

                        <div class="form-group col-md-3 mb-0">
                            {{form.warranty_expiry|as_crispy_field}}

                        </div>

                        <div class="form-group col-md-3 mb-0">
                            {{form.tpm_expiry|as_crispy_field}}
                    </div>
                    <div class="form-group col-md-3 mb-0">
                        {{form.status|as_crispy_field}}

                    </div>
                    <div class="form-group col-md-3 mb-0">
                        {{form.location|as_crispy_field}}

                    </div>
                    {% comment %} <div class="form-group col-md-3 mb-0">
                        {{form.assigned_to|as_crispy_field}}

                    </div> {% endcomment %}
                    </div>
                    <button type="submit" class="btn btn-outline-primary">Submit</button>
                </form>
                {% comment %} {{form.errors}} {% endcomment %}
        </div>
    </div>
</div>

<script type="text/javascript">
// In your Javascript (external .js resource or <script> tag)
    $(document).ready(function() {
        $('#id_softwaretype').select2();
    });

</script>
{% comment %} <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script> {% endcomment %}
<script>
    $(document).ready(function() {
        $("#id_category").change(function () {
                    const url = $("#HardwareCreateForm").attr("data-category-url");  // get the url of the `load_cities` view
            const categoryId = $(this).val();  // get the selected country ID from the HTML input

            $.ajax({                       // initialize an AJAX request
                url: url,                    // set the url of the request (= /persons/ajax/load-cities/ )
                data: {
                    'category_id': categoryId       // add the country id to the GET parameters
                },
                success: function (data) {   // `data` is the return of the `load_cities` view function
                    $("#id_subcategory").html(data);  // replace the contents of the city input with the data that came from the server
                    {% comment %} /*

                    let html_data = '<option value="">---------</option>';
                    data.forEach(function (city) {
                        html_data += `<option value="${city.id}">${city.name}</option>`
                    });
                    console.log(html_data);
                    $("#id_city").html(html_data);

                    */ {% endcomment %}
                }
            });

        });
    });
</script>
{% endblock body %}